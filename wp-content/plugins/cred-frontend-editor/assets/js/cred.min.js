(function(f,b,i,j,n,v,u){var q=null,m={},o,w,l={toggleHighlight:function(){var e="0",e=b(this),a=e.closest(".wp-editor-wrap"),d=a.find(".ed_button"),k=a.find(".switch-text"),c=a.find(".switch-syntax"),a=a.find(".wp-switch-editor");e.hasClass("switch-text")?(d.show(),a.removeClass("switch-html").addClass("switch-tmce"),k.removeClass("switch-tmce").addClass("switch-html"),l.toggleCodeMirror(!1),e="0"):(d.hide(),a.removeClass("switch-html").addClass("switch-tmce"),c.removeClass("switch-tmce").addClass("switch-html"),
l.toggleCodeMirror(!0),e="1");b.ajax({url:t.route("/Settings/toggleHighlight"),timeout:1E4,type:"POST",data:{cred_highlight:e},dataType:"html",success:function(){},error:function(){}})},makeResizable:function(e){var a,d=!1,k=e.attr("id"),c=function(){m[k]&&m[k].setSize(e.width(),e.height())};j.waitUntilElement("#content-resize-handle",function(){b("#content-resize-handle").on("mousedown",function(){d||(d=!0,a=setInterval(c,100))});b(document).on("mouseup",function(){d&&(clearInterval(a),d=!1)});b(f).resize(function(){c()})})},
makeAreaResizable:function(e){(function(){function a(a){e.height(Math.max(50,c+a.pageY)+"px");m[k]&&m[k].setSize(null,e.height());return!1}function d(){var c;e.focus();b(document).unbind("mousemove",a).unbind("mouseup",d);(c=parseInt(e.css("height"),10))&&c>50&&c<5E3&&j.setUserSetting("cred_settings",k+"_size",c)}var k=e.attr("id"),c=null;e.length&&!("ontouchstart"in f)&&(e.css("resize","none"),e.closest(".cred-editor-wrap").find(".cred-content-resize-handle").on("mousedown",function(k){c=e.height()-
k.pageY;e.blur();b(document).mousemove(a).mouseup(d);return!1}))})()},enableExtraCodeMirror:function(){if(f.CodeMirror){var e=b("#cred-extra-css-editor"),a=b("#cred-extra-js-editor"),d;j.swapEl(e,function(){m["cred-extra-css-editor"]=CodeMirror.fromTextArea(e[0],{mode:"css",tabMode:"indent",lineWrapping:!0,lineNumbers:!0});d=Math.min(5E3,Math.max(50,j.getUserSetting("cred_settings","cred-extra-css-editor_size",300)));e.css("resize","none").height(d+"px");m["cred-extra-css-editor"].setSize(null,d);
l.makeAreaResizable(e)});e.hide();j.swapEl(a,function(){m["cred-extra-js-editor"]=CodeMirror.fromTextArea(a[0],{mode:"javascript",tabMode:"indent",lineWrapping:!0,lineNumbers:!0});d=Math.min(5E3,Math.max(50,j.getUserSetting("cred_settings","cred-extra-js-editor_size",300)));a.css("resize","none").height(d+"px");m["cred-extra-js-editor"].setSize(null,d);l.makeAreaResizable(a)});a.hide()}},toggleCodeMirror:function(e){var a;if(f.CodeMirror)if(!e&&m.content)return m.content.toTextArea(),m.content=!1,
!e;else if(e&&!m.content){CodeMirror.defineMode("myshortcodes",codemirror_shortcodes_overlay);var d=b("#content").closest(".postbox"),k=!1,c=!1;if(d.hasClass("closed")||"none"==d.css("display"))k=!0,d.removeClass("closed");"none"==d.css("display")&&(c="none",d.css("display","block"));m.content=CodeMirror.fromTextArea(document.getElementById("content"),{mode:"myshortcodes",tabMode:"indent",lineWrapping:!0,lineNumbers:!0,onKeyEvent:function(b,e){var c=e.keyCode||e.charCode;c!=a&&((13==c||8==a||46==
a)&&jQuery(document).triggerHandler("wpcountwords",[b.getValue()]),a=c)}});var y=Math.min(5E3,Math.max(50,getUserSetting("ed_size")));b("#content").css("resize","none").height(y+"px");m.content.setSize(b("#content").width(),y);"none"==c&&d.css("display","none");k&&d.addClass("closed");return e}return!1},genScaffold:function(){var e=q;if(!e||!e.post_fields)return n.Popups.alert({message:i.locale.form_types_not_set,"class":"cred-dialog"}),!1;var a=!1;b("#cred_include_wpml_scaffold").is(":checked")&&
(a=!0);var d=b("#title").val();if(b.trim(d)=="")return n.Popups.alert({message:i.locale.set_form_title,"class":"cred-dialog"}),!1;var k=b("#post_ID").val(),c=b("#cred-scaffold-area"),f="",h=0,g;for(g in e.groups)if(e.groups.hasOwnProperty(g)){h++;var j=e.groups[g],j=j.split(",");f+=l.groupOutput(g,j,e.custom_fields,k,d,a,"\t")+"\r\n"}h="";if(parseInt(e.taxonomies_count,10)>0)for(g in e.taxonomies)e.taxonomies.hasOwnProperty(g)&&(h+=l.taxOutput(e.taxonomies[g],k,d,a,"")+"\r\n");j="";if(parseInt(e.parents_count,
10)>0)for(g in e.parents)e.parents.hasOwnProperty(g)&&(j+=l.fieldOutput(e.parents[g],k,d,a,"","date","desc",0,!1,"No Parent","-- Select "+e.parents[g].data.post_type+" --",e.parents[g].data.post_type+" must be selected")+"\r\n");g="";g+="minimal"==o.get("[form][theme]")?'[credform class="cred-form cred-keep-original"]\r\n\r\n':'[credform class="cred-form"]\r\n\r\n';g+="\t"+l.shortcode(e.form_fields.form_messages)+"\r\n\r\n";g+=l.fieldOutput(e.post_fields.post_title,k,d,a,"\t")+"\r\n\r\n";e.post_fields.post_content.supports&&
(g+=l.fieldOutput(e.post_fields.post_content,k,d,a,"\t")+"\r\n\r\n");e.post_fields.post_excerpt.supports&&(g+=l.fieldOutput(e.post_fields.post_excerpt,k,d,a,"\t")+"\r\n\r\n");e.extra_fields._featured_image.supports&&(g+=l.fieldOutput(e.extra_fields._featured_image,k,d,a,"\t")+"\r\n\r\n");g+=f;parseInt(e.taxonomies_count,10)>0&&(g+=l.groupOutputContent("taxonomies","Taxonomies",h,"\t")+"\r\n\r\n");parseInt(e.parents_count,10)>0&&(g+=l.groupOutputContent("parents","Parents",j,"\t")+"\r\n\r\n");b("#cred_include_captcha_scaffold").is(":checked")&&
(g+='\t<div class="cred-field cred-field-recaptcha">'+l.shortcode(e.extra_fields.recaptcha)+"</div>\r\n\r\n");g+="\t"+l.shortcode(e.form_fields.form_submit)+"\r\n\r\n";g+="[/credform]\r\n";c.val(g);return!0},onLoad:function(e){var a=null,d,k=b("#cred-shortcodes-box-inner");k.empty();q=e;if(e.form_fields&&parseInt(e.form_fields_count)>0){a=b('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.form_fields+"</a></div>");d=b('<div class="cred-accordeon-item-inside"></div>');
a.append(d);k.append(a);resp2=e.form_fields;for(var c in resp2)resp2.hasOwnProperty(c)&&(a=b("<a href='javascript:;' class='button cred_field_add' title='"+resp2[c].description+"'>"+resp2[c].name+"</a>"),a.data("field",resp2[c]),d.append(a))}if(e.post_fields&&parseInt(e.post_fields_count)>0)for(c in a=b('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.post_fields+"</a></div>"),d=b('<div class="cred-accordeon-item-inside"></div>'),a.append(d),k.append(a),
resp2=e.post_fields,resp2)resp2.hasOwnProperty(c)&&(a=b("<a href='javascript:;' class='button cred_field_add' title='"+resp2[c].description+"'>"+resp2[c].name+"</a>"),a.data("field",resp2[c]),d.append(a));if(e.custom_fields&&parseInt(e.custom_fields_count)>0)for(c in a=b('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.custom_fields+"</a></div>"),d=b('<div class="cred-accordeon-item-inside"></div>'),a.append(d),k.append(a),resp2=e.custom_fields,
resp2)resp2.hasOwnProperty(c)&&(a=b("<a href='javascript:;' class='button cred_field_add' title='"+resp2[c].description+"'>"+resp2[c].name+"</a>"),a.data("field",resp2[c]),d.append(a));if(e.taxonomies&&parseInt(e.taxonomies_count)>0)for(c in a=b('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.taxonomy_fields+"</a></div>"),d=b('<div class="cred-accordeon-item-inside"></div>'),a.append(d),k.append(a),resp2=e.taxonomies,resp2)if(resp2.hasOwnProperty(c))resp2[c].taxonomy=
!0,a=b("<a href='javascript:;' class='button cred_field_add'>"+resp2[c].label+"</a>"),a.data("field",resp2[c]),d.append(a),resp2[c].hierarchical?(resp2[c].aux={master_taxonomy:resp2[c].name,name:resp2[c].name+"_add_new",add_new_taxonomy:!0},a=b("<a href='javascript:;' class='button cred_field_add'>"+resp2[c].label+" Add New</a>")):(resp2[c].aux={master_taxonomy:resp2[c].name,name:resp2[c].name+"_popular",popular:!0},a=b("<a href='javascript:;' class='button cred_field_add'>"+resp2[c].label+" Popular</a>")),
a.data("field",resp2[c].aux),d.append(a);if(e.parents&&parseInt(e.parents_count)>0)for(c in a=b('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.parent_fields+"</a></div>"),d=b('<div class="cred-accordeon-item-inside"></div>'),a.append(d),k.append(a),resp2=e.parents,resp2)resp2.hasOwnProperty(c)&&(a=b("<a href='javascript:;' class='button cred_field_add' title='"+resp2[c].description+"'>"+resp2[c].name+"</a>"),a.data("field",resp2[c]),d.append(a));
if(e.extra_fields&&parseInt(e.extra_fields_count)>0){a=b('<div class="cred-accordeon-item"><a href="javascript:;" class="cred-fields-group-heading">'+i.locale.extra_fields+"</a></div>");d=b('<div class="cred-accordeon-item-inside"></div>');a.append(d);k.append(a);resp2=e.extra_fields;e=[];for(c in resp2)resp2.hasOwnProperty(c)&&(resp2[c].disabled?(a=b("<div class='cred_disabled_container'><a href='javascript:;' class='button cred_field_disabled' disabled='disabled'>"+resp2[c].name+"</a><span class='cred-field-disabled-reason'>"+
resp2[c].disabled_reason+"</span></div>"),a.data("field",resp2[c]),e.push(a)):(a=b("<a href='javascript:;' class='button cred_field_add' title='"+resp2[c].description+"'>"+resp2[c].name+"</a>"),a.data("field",resp2[c]),d.append(a)));for(c=0;c<e.length;c++)d.append(e[c])}},shortcode:function(b,a){var d="",k="",c=' value=""';if(b&&b.slug){b.post_type&&(k=' post="'+b.post_type+'"');b.value&&(c=' value="'+b.value+'"');!b.taxonomy&&!b.is_parent&&"form_messages"!=b.type&&(c+=' urlparam=""');if(b.type==
"image"||b.type=="file"){var d=a&&a.max_width?a.max_width:!1,f=a&&a.max_height?a.max_height:!1;d&&!isNaN(d)&&(c+=' max_width="'+d+'"');f&&!isNaN(f)&&(c+=' max_height="'+f+'"')}if(b.is_parent){var d=a&&a.parent_order?a.parent_order:!1,f=a&&a.parent_ordering?a.parent_ordering:!1,h=a&&a.parent_max_results?a.parent_max_results:!1,g=a&&a.required?a.required:!1,j=a&&a.no_parent_text?a.no_parent_text:!1,l=a&&a.select_parent_text?a.select_parent_text:!1,i=a&&a.validate_parent_text?a.validate_parent_text:
!1;h!==!1&&!isNaN(h)&&(c+=' max_results="'+h+'"');d&&(c+=' order="'+d+'"');f&&(c+=' ordering="'+f+'"');g&&(c+=' required="'+g.toString()+'"');g&&l!==!1&&(c+=' select_text="'+l+'"');g&&i!==!1&&(c+=' validate_text="'+i+'"');!g&&j!==!1&&(c+=' no_parent_text="'+j+'"')}if(b.type=="textfield"||b.type=="textarea"||b.type=="wysiwyg"||b.type=="date"||b.type=="phone"||b.type=="url"||b.type=="numeric"||b.type=="email")d=a&&a.readonly?a.readonly:!1,f=a&&a.escape?a.escape:!1,h=a&&a.placeholder?a.placeholder:!1,
d&&(c+=' readonly="'+d.toString()+'"'),f&&(c+=' escape="'+f.toString()+'"'),h&&""!=h&&(c+=' placeholder="'+h+'"');d='[cred_field field="'+b.slug+'"'+k+c+"]"}b&&b.taxonomy&&(d=b.hierarchical?'[cred_field field="'+b.name+'" display="checkbox"]':'[cred_field field="'+b.name+'"]');b&&b.popular&&(d='[cred_field field="'+b.name+'" taxonomy="'+b.master_taxonomy+'" type="show_popular"]');b&&b.add_new_taxonomy&&(d='[cred_field field="'+b.name+'" taxonomy="'+b.master_taxonomy+'" type="add_new"]');return d},
fieldOutput:function(b,a,d,k,c){c||(c="");var f=[],k=k||!1;if(b){k?(f.push(c+'<div class="cred-field cred-field-'+b.slug+'">'),f.push(c+'\t<div class="cred-label">[wpml-string context="cred-form-'+d+"-"+a+'" name="'+b.name+'"]'+b.name+"[/wpml-string]</div>")):(f.push(c+'<div class="cred-field cred-field-'+b.slug+'">'),f.push(c+'\t<div class="cred-label">'+b.name+"</div>"));var h=[b],h=arguments.length==5?h.concat(Array.prototype.slice.call(arguments,6)):h.concat(Array.prototype.slice.call(arguments,
5));f.push(c+"\t"+l.shortcode.apply(null,h));f.push(c+"</div>")}return f.join("\r\n")},groupOutput:function(b,a,d,f,c,j,h){h||(h="");var g=[],i="cred-group-"+b.replace(/\s+/g,"-");g.push(h+'<div class="cred-group '+i+'">');g.push(h+"\t<div><h2>"+b+"</h2></div>");for(b=0;b<a.length;b++)d[a[b]]._cred_ignore||g.push(l.fieldOutput(d[a[b]],f,c,j,h+"\t"));g.push(h+"</div>");return g.join("\r\n")+"\r\n"},groupOutputContent:function(b,a,d,f){f||(f="");a=[];b="cred-group-"+b.replace(/\s+/g,"-");a.push(f+'<div class="cred-group '+
b+'">');d=d.split("\r\n");for(b=0;b<d.length;b++)d[b]=f+"\t"+d[b];d=d.join("\r\n");a.push(d);a.push(f+"</div>");return a.join("\r\n")},taxOutput:function(b,a,d,f,c){f=f||!1;c||(c="");var j=[];j.push(c+'<div class="cred-taxonomy cred-taxonomy-'+b.name+'">');f?j.push(c+'\t<div class="cred-label"><h2>[wpml-string context="cred-form-'+d+"-"+a+'" name="'+b.label+'"]'+b.label+"[/wpml-string]</h2></div>"):j.push(c+'\t<div class="cred-label"><h2>'+b.label+"</h2></div>");j.push(c+"\t"+l.shortcode(b));j.push(c+
'\t<div class="cred-taxonomy-auxilliary cred-taxonomy-auxilliary-'+b.aux.name+'">');j.push(c+"\t\t"+l.shortcode(b.aux));j.push(c+"\t</div>");j.push(c+"</div>");return j.join("\r\n")},formPreview:function(){var e=j.getContent(b("#content"));if(""==b.trim(e))return!1;var a=o.get("[post][post_type]"),d=o.get("[form][type]"),k=o.get("[form][theme]"),c=j.getContent(b("#cred-extra-css-editor")),l=j.getContent(b("#cred-extra-js-editor")),h,g,x;if(!a||a==""||!d||d=="")return n.Popups.alert({message:i.locale.form_types_not_set,
"class":"cred-dialog"}),!1;g=b("#post_ID").val();x="CRED_Preview_"+g;g=i.homeurl+"index.php?cred_form_preview="+g;f.open("",x,"status=0,title=0,height=600,width=800,scrollbars=1,resizable=1")?(h=b("<form style='display:none' name='cred_form_preview_form' method='post' target='"+x+"' action='"+g+"'><input type='hidden' name='_cred_cred_prefix_form_css_to_use' value='"+k+"' /><input type='hidden' name='_cred_cred_prefix_form_preview_post_type' value='"+a+"' /><input type='hidden' name='_cred_cred_prefix_form_preview_form_type' value='"+
d+"' /><textarea  name='_cred_cred_prefix_form_preview_content'>"+j.stripslashes(e)+"</textarea><textarea  name='_cred_cred_prefix_extra_css_to_use'>"+c+"</textarea><textarea  name='_cred_cred_prefix_extra_js_to_use'>"+l+"</textarea></form>"),b(document.body).append(h),h.submit(),setTimeout(function(){h.remove()},1E3)):n.Popups.alert({message:i.locale.enable_popup_for_preview,"class":"cred-dialog"});return!1}},t={app:j,gui:n,mvc:v,settings:i,route:function(b,a,d){return j.route("cred",i.ajaxurl,b,
a,d)},getFormFields:function(b){var e;if(!q)return[];var b=j.getContent(b).replace(/[\n\r]+/g," "),a=q,d=[{rx:/\[cred\-field\b[^\[\]]*field=[\"\']([\d\w\-_]+)[\"\'][^\[\]]*?\]/g,field:1,type:!1,generic:!1},{rx:/\[cred_field\b[^\[\]]*field=[\"\']([\d\w\-_]+)[\"\'][^\[\]]*?\]/g,field:1,type:!1,generic:!1},{rx:/\[cred\-generic\-field\b([^\[\]]*?)\](.+?)\[\/cred\-generic\-field\]/g,atts:1,content:2,generic:!0},{rx:/\[cred_generic_field\b([^\[\]]*?)\](.+?)\[\/cred_generic_field\]/g,atts:1,content:2,generic:!0}],
f=[],c,l,h,g,i,p,r,m,z=/field=[\"\']([\d\w\-_]+?)[\"\'][^\[\]]*?\btype=[\"\']([\d\w\-_]+?)[\"\']/,A=/type=[\"\']([\d\w\-_]+?)[\"\'][^\[\]]*?\bfield=[\"\']([\d\w\-_]+?)[\"\']/,B=/["']persist["']\s*\:\s*(\d)/;c=0;for(l=d.length;c<l;c++)if(d[c].generic)for(;h=d[c].rx.exec(b);){p=!1;r=!0;i=d[c].atts&&h[d[c].atts]?z.exec(h[d[c].atts]):!1;g=d[c].atts&&h[d[c].atts]?A.exec(h[d[c].atts]):!1;h=d[c].content&&h[d[c].content]?B.exec(h[d[c].content]):!1;if(i)g=i[1],i=i[2];else if(g)i=g[1],g=g[2];else continue;
m=h&&h[1]&&"1"==h[1]?!0:!1;f.push({name:g,field:g,type:i,repetitive:p,persistent:m,generic:r})}else for(;h=d[c].rx.exec(b);)if(e=g=!1!==d[c].field&&h[d[c].field]?h[d[c].field]:!1,h=e,r=p=!1,m=!0,g)a.post_fields[g]?(i=a.post_fields[g].type,a.post_fields[g].data&&a.post_fields[g].data.repetitive&&a.post_fields[g].data.repetitive=="1"&&(p=!0),a.post_fields[g].plugin_type_prefix&&(g=a.post_fields[g].plugin_type_prefix+h),f.push({name:h,field:g,type:i,repetitive:p,persistent:m,generic:r})):a.custom_fields[g]?
(i=a.custom_fields[g].type,a.custom_fields[g].data&&a.custom_fields[g].data.repetitive&&a.custom_fields[g].data.repetitive=="1"&&(p=!0),a.custom_fields[g].plugin_type_prefix&&(g=a.custom_fields[g].plugin_type_prefix+h),f.push({name:h,field:g,type:i,repetitive:p,persistent:m,generic:r})):a.parents[g]?(i=a.parents[g].type,a.parents[g].data&&a.parents[g].data.repetitive&&a.parents[g].data.repetitive=="1"&&(p=!0),a.parents[g].plugin_type_prefix&&(g=a.parents[g].plugin_type_prefix+h),f.push({name:h,field:g,
type:i,repetitive:p,persistent:m,generic:r})):a.taxonomies[g]&&(i="taxonomy",a.taxonomies[g].plugin_type_prefix&&(g=a.taxonomies[g].plugin_type_prefix+h),f.push({name:h,field:g,type:i,repetitive:p,persistent:m,generic:r}));return f},doCheck:function(){var e=b("#title").val();if(/[\#\@\[\]\'\"\!\/\\]/g.test(e)||e.length<=0)return n.Popups.alert({message:i.locale.invalid_title,"class":"cred-dialog"}),!1;return!0},getContents:function(){return{content:j.getContent(b("#content")),"cred-extra-css-editor":j.getContent(b("#cred-extra-css-editor")),
"cred-extra-js-editor":j.getContent(b("#cred-extra-js-editor"))}},getFieldData:function(){return q},getCodeMirror:function(){return m.content},getCSSCodeMirror:function(){return m["cred-extra-css-editor"]},getJSCodeMirror:function(){return m["cred-extra-js-editor"]},getModel:function(){return o},getView:function(){return w},forms:function(e){var a=b("#post");b("#credformtypediv");b("#credposttypediv");b("#credformcontentdiv");var d=b("#postdivrich"),k=b("#credextradiv");b("#credmessagesdiv");b("#crednotificationdiv");
var c=b("#cred_ajax_loader_small_id");o=new v.Model("_cred",f._credFormData);w=new v.View("cred",o,{init:function(){function d(){h.isValid=!0;h.getElements(".cred_validation_section").each(function(){var a=b(this),c=!0;a.find("input, select, textarea").each(function(){var a=b(this);u!==a[0].__isCredValid&&(a[0].__isCredValid||(c=!1))});c?a.find(".cred-notification.cred-error.cred-section-validation-message").hide():(h.isValid=!1,a.find(".cred-notification.cred-error.cred-section-validation-message").show())})}
function e(){if(q&&q.post_fields){for(var a=t.getFormFields(),c=[],d=[],g=[],f=0,h=a.length;f<h;f++)a[f].persistent&&((a[f].type=="mail"||a[f].type=="email")&&c.push({value:a[f].field,label:a[f].name}),-1==b.inArray(a[f].field,["post_title","post_content","post_excerpt"])&&(a[f].type=="text"||a[f].type=="textfield")&&g.push({value:a[f].field,label:a[f].name}),(a[f].type=="select"||a[f].type=="radio")&&d.push({value:a[f].field,label:a[f].name}));k.set("[_persistent_mail_fields]",c).set("[_persistent_text_fields]",
g).set("[_persistent_select_fields]",d).set("[_all_persistent_meta_fields]",[].concat(c,g,d)).trigger("change")}}var h=this,k=this._model;h.isValid=!0;h.action("refreshFormFields",function(){e();n.Popups.flash({message:i.locale.refresh_done,"class":"cred-dialog"})}).action("validateSection",function(b,a){if(a&&u!==a.validationResult)b[0].__isCredValid=a.validationResult}).action("fadeSlide",function(a,c){if(c.bind)c=c.bind,c.domRef&&(a=b(c.domRef)),c.condition?(c.condition=k.eval(c.condition),u!==
c.condition&&(c.condition?a.slideFadeDown("slow","quintEaseOut"):a.slideFadeUp("slow","quintEaseOut"))):a.slideFadeDown("slow","quintEaseOut")}).action("fadeIn",function(a,c){if(c.bind)c=c.bind,c.domRef&&(a=b(c.domRef)),c.condition?(c.condition=k.eval(c.condition),u!==c.condition&&(c.condition?a.stop().fadeIn("slow"):a.stop().fadeOut("slow",function(){b(this).hide()}))):a.stop().fadeIn("slow")}).func("confirm",function(a,c){n.Popups.confirm({message:a,"class":"cred-dialog",buttons:[i.locale.Yes,i.locale.No],
primary:i.locale.Yes,callback:function(a){b.isFunction(c)&&(a==i.locale.Yes?c.call(h,!0):c.call(h,!1))}})}).event("model:change",function(a,d){if("[post][post_type]"==d.key)c.show(),b.ajax({url:t.route("/Forms/getPostFields"),timeout:1E4,type:"POST",data:"post_type="+d.value,dataType:"json",success:function(b){l.onLoad(b);j.dispatch("cred.fieldsLoaded");c.hide()}});else if(/^\[notification\]\[notifications\]\[\d+\]/.test(d.key)){var e=k.count("[notification][notifications]"),g=k.get("[notification][enable]");
0==e&&("1"==g||1==g)&&k.set("[notification][enable]","",!0);if(g=/^\[notification\]\[notifications\]\[(\d+)\]$/.exec(d.key)){if(f.tinyMCEPreInit){e="credmailbody"+g[1];if(typeof f.tinymce=="object"&&f.tinyMCEPreInit.mceInit.credmailbody__i__)if(f.tinyMCEPreInit.mceInit[e])f.tinyMCE.execCommand("mceFocus",!1,e),f.tinyMCE.execCommand("mceRemoveControl",!1,e);else{f.tinyMCEPreInit.mceInit[e]=tinymce.extend({},f.tinyMCEPreInit.mceInit.credmailbody__i__);for(var i in{body_class:1,elements:1})f.tinyMCEPreInit.mceInit[e][i]&&
(f.tinyMCEPreInit.mceInit[e][i]=f.tinyMCEPreInit.mceInit[e][i].replace(/__i__/g,g[1]));var m=f.tinymce.DOM;m.events.add(m.select("#wp-"+e+"-wrap"),"mousedown",function(){if(this.id)f.wpActiveEditor=this.id.slice(3,-5)});try{f.tinymce.init(f.tinyMCEPreInit.mceInit[e])}catch(n){}}if(f.tinyMCEPreInit.qtInit&&f.tinyMCEPreInit.qtInit.credmailbody__i__&&!f.tinyMCEPreInit.qtInit[e]){f.tinyMCEPreInit.qtInit[e]=b.extend({},f.tinyMCEPreInit.qtInit.credmailbody__i__);for(i in{id:1})f.tinyMCEPreInit.qtInit[e][i]&&
(f.tinyMCEPreInit.qtInit[e][i]=f.tinyMCEPreInit.qtInit[e][i].replace(/__i__/g,g[1]));if(typeof f.tinymce!="object")i=f.tinyMCEPreInit.qtInit[e].id,document.getElementById("wp-"+i+"-wrap").onmousedown=function(){f.wpActiveEditor=this.id.slice(3,-5)};if(typeof f.QTags=="function"){i=f.QTags.instances;var s;f.QTags.instances={};try{s=f.quicktags(f.tinyMCEPreInit.qtInit[e]),f.QTags.instances[e]=s,f.QTags._buttonsInit()}catch(o){}f.QTags.instances=i;f.QTags.instances[e]=s;b("#"+e+"-tmce").trigger("click");
b("#wp-"+e+"-wrap").removeClass("html-active").addClass("tmce-active");f.switchEditors.switchto(document.getElementById(e+"-tmce"))}}}}else if(g=/^\[notification\]\[notifications\]\[(\d+)\]\[event\]\[type\]$/.exec(d.key))s=h.getElements("#cred_mail_subject_placeholders-"+g[1]).find("a.cred_field_add_code").add(h.getElements("#cred_mail_body_placeholders-"+g[1]).find("a.cred_field_add_code")),"form_submit"==d.value?s.filter(function(){var a=b(this).data("value");if(b.inArray(a,["%%FORM_DATA%%","%%POST_PARENT_TITLE%%",
"%%POST_PARENT_LINK%%"])>-1)return!0;return!1}).prop("disabled",!1).show():s.filter(function(){var a=b(this).data("value");if(b.inArray(a,["%%FORM_DATA%%","%%POST_PARENT_TITLE%%","%%POST_PARENT_LINK%%"])>-1)return!0;return!1}).prop("disabled",!0).hide(),j.dispatch("cred.notificationEventChanged",d.value,s)}}).event("view:change",function(b,a){if(a.el&&a.bind&&a.el.hasClass("cred-notification-add-button")){var c=k.count("[notification][notifications]"),e=k.get("[notification][enable]");1==c&&(""==
e||0==e)&&k.set("[notification][enable]","1",!0)}d()});j.attach("cred.fieldsLoaded cred.insertField cred.insertScaffold",e);a.on("click",".cred-tip-link .icon-question-sign",function(a){a.preventDefault();a.stopPropagation();var c=b(this),a=c.parent();c.hasClass("active")?c[0]._pointer&&c[0]._pointer.pointer("close"):(c.addClass("active"),c[0]._pointer=n.Popups.pointer(a,{message:b(a.data("pointer-content")).html(),"class":"cred-pointer",callback:function(){c.removeClass("active")}}))}).on("click",
".cred_field_add_code",function(a){a.stopPropagation();a.preventDefault();var c=b(this),a=b(c.data("area")),d=c.data("value");j.InsertAtCursor(a,d);setTimeout(function(){c.closest(".cred-popup-box").__hide();c.closest(".cred-icon-button").css("z-index",1)},50);return!1}).on("paste keyup change",".js-test-notification-to",function(){var a=b(this),c=a.val(),a=b(a.data("sendbutton"));""==c?a.attr("disabled","disabled"):a.removeAttr("disabled")}).on("click",".js-send-test-notification",function(a){a.preventDefault();
var c=b(this),d=null,e={},a=b(c.data("addressfield")).val(),g=b(c.data("cancelbutton")),f=b(c.data("loader")),h=b(c.data("results")).empty().hide(),i=b("#post_ID").val(),j=function(){d&&(d.abort(),d=!1);g.unbind("click",j);c.removeAttr("disabled")},e=b.extend(e,k.get("[notification][notifications]["+c.data("notification")+"]"));delete e.event;e.to.type=["specific_mail"];e.to.specific_mail.address=a;e={cred_test_notification_data:e,cred_form_id:i};g.unbind("click",j).bind("click",j);c.attr("disabled",
"disabled");h.html("sending test notification to &quot;"+a+"&quot; ..").show();f.show();d=b.ajax(t.route("/Forms/testNotification"),{data:e,dataType:"json",type:"POST",success:function(b){b.error?h.html('<div class="cred-error">'+b.error+"</div>"):h.html('<div class="cred-success">'+b.success+"</div>");h.hide().fadeIn("slow");f.hide();d=!1;j()},error:function(b){f.hide();h.empty().hide();n.Popups.alert({message:"AJAX Request failed!<br /><br />Response Code: "+b.status+"<br /><br />Response Message: "+
b.responseText,"class":"cred-dialog"});d=!1;j()}})});b("#cred-preview-button a").unbind("click").bind("click",function(b){b.preventDefault();return l.formPreview()});a.bind("submit",function(){if(t.doCheck()){var c=b("#crednotificationdiv");c.hasClass("closed")&&(c.removeClass("closed"),h.forceValidation(),d(),h.isValid&&c.addClass("closed"));h.isValid?b("#_cred_form_not_valid").remove():a.append('<input style="display:none" type="hidden" id="_cred_form_not_valid" name="_cred[validation][fail]" value="1" />');
return!0}return!1});var m=b("#cred-shortcodes-box");m.on("click","a.cred-fields-group-heading",function(a){a.stopPropagation();a.preventDefault();a=b(this).next();b("#cred-shortcodes-box-inner .cred-accordeon-item").removeClass("cred-accordeon-item-active");b(this).closest(".cred-accordeon-item").addClass("cred-accordeon-item-active");b("#cred-shortcodes-box-inner .cred-accordeon-item-inside").not(a).stop(!1).slideUp("fast");a.stop(!1).slideDown({duration:"slow",easing:"quintEaseOut"})});m.on("click",
"a.cred_field_add",function(c){c.stopPropagation();c.preventDefault();var d=b(this).data("field"),e;a.find(".additional_field_options_popup").remove();if(d.slug=="credform")e="["+d.slug+"]\n[/"+d.slug+"]";else if(d.type=="image")return b(b("#cred_image_dimensions_validation_template").html()).appendTo("#cred-shortcodes-box"),b("#cred_image_dimensions_validation").__show(),b("#cred_image_dimensions_cancel_button").unbind("click").click(function(a){a.stopPropagation();a.preventDefault();setTimeout(function(){b("#cred_image_dimensions_validation").__hide()},
50)}),b("#cred_image_dimensions_validation_button").unbind("click").click(function(a){a.stopPropagation();a.preventDefault();var a=parseInt(b.trim(b("#cred_max_width").val()),10),c=parseInt(b.trim(b("#cred_max_height").val()),10);e=l.shortcode(d,{max_width:a,max_height:c});j.InsertAtCursor(b("#content"),e);j.dispatch("cred.insertField");setTimeout(function(){b("#cred-shortcodes-box").__hide();b("#cred-shortcode-button").css("z-index",1)},50)}),!1;else if(d.type=="textfield"||d.type=="textarea"||d.type==
"wysiwyg"||d.type=="date"||d.type=="url"||d.type=="phone"||d.type=="numeric"||d.type=="email")return b(b("#cred_text_extra_options_template").html()).appendTo("#cred-shortcodes-box"),b("#cred_text_extra_options").__show(),b("#cred_text_extra_options_cancel_button").unbind("click").click(function(a){a.stopPropagation();a.preventDefault();setTimeout(function(){b("#cred_text_extra_options").__hide()},50)}),b("#cred_text_extra_options_button").unbind("click").click(function(a){a.stopPropagation();a.preventDefault();
var a=b.trim(b("#cred_text_extra_placeholder").val()),c=b("#cred_text_extra_readonly").is(":checked");e=l.shortcode(d,{placeholder:a,readonly:c,escape:!1});j.InsertAtCursor(b("#content"),e);j.dispatch("cred.insertField");setTimeout(function(){b("#cred-shortcodes-box").__hide();b("#cred-shortcode-button").css("z-index",1)},50)}),!1;else if(d.is_parent)return b(b("#cred_parent_field_settings_template").html()).appendTo("#cred-shortcodes-box"),b("#cred_parent_field_settings #cred_parent_required").unbind("change").bind("change",
function(){b(this).is(":checked")?(b("#cred_parent_field_settings #cred_parent_select_text_container").stop(!0).slideFadeDown("fast"),b("#cred_parent_field_settings #cred_parent_no_parent_container").stop(!0).slideFadeUp("fast")):(b("#cred_parent_field_settings #cred_parent_select_text_container").stop(!0).slideFadeUp("fast"),b("#cred_parent_field_settings #cred_parent_no_parent_container").stop(!0).slideFadeDown("fast"))}),b("#cred_parent_select_text").val("--- Select "+d.data.post_type+" ---"),
b("#cred_parent_validation_text").val(d.data.post_type+" must be selected"),b("#cred_parent_no_parent_text").val("No Parent"),setTimeout(function(){b("#cred_parent_field_settings #cred_parent_required").trigger("change")},50),b("#cred_parent_field_settings").__show(),b("#cred_parent_extra_cancel_button").unbind("click").click(function(a){a.stopPropagation();a.preventDefault();setTimeout(function(){b("#cred_parent_field_settings").__hide()},50)}),b("#cred_parent_extra_button").unbind("click").click(function(a){a.stopPropagation();
a.preventDefault();var a=b("#cred_parent_order_by").val(),c=b("#cred_parent_ordering").val(),f=parseInt(b.trim(b("#cred_parent_max_results").val()),10),g=b("#cred_parent_required").is(":checked"),h=b("#cred_parent_no_parent_text").val(),i=b("#cred_parent_select_text").val(),k=b("#cred_parent_validation_text").val();e=l.shortcode(d,{parent_order:a,parent_ordering:c,parent_max_results:f,required:g,no_parent_text:h,select_parent_text:i,validate_parent_text:k});j.InsertAtCursor(b("#content"),e);j.dispatch("cred.insertField");
setTimeout(function(){b("#cred-shortcodes-box").__hide();b("#cred-shortcode-button").css("z-index",1)},50)}),!1;else e=l.shortcode(d);j.InsertAtCursor(b("#content"),e);j.dispatch("cred.insertField");setTimeout(function(){b("#cred-shortcodes-box").__hide();b("#cred-shortcode-button").css("z-index",1)},50)});b("#cred-scaffold-box").on("click","#cred-scaffold-insert",function(a){a.stopPropagation();a.preventDefault();a=b("#cred-scaffold-area").val();j.InsertAtCursor(b("#content"),a);j.dispatch("cred.insertScaffold");
setTimeout(function(){b("#cred-scaffold-box").__hide();b("#cred-scaffold-button").css("z-index",1)},50)});a.on("click","#cred-shortcode-button-button",function(c){c.stopPropagation();c.preventDefault();a.find(".cred-media-button").css("z-index",1);a.find(".cred-popup-box").hide();b(this).closest(".cred-media-button").css("z-index",100);a.find(".additional_field_options_popup").hide();b("#cred-shortcodes-box").__show();b(".cred-accordeon-item-active").length===0&&b(".cred-accordeon-item:first-child").addClass("cred-accordeon-item-active").find(".cred-accordeon-item-inside").stop().slideDown("fast")});
a.on("click","#cred-generic-shortcode-button-button",function(c){c.stopPropagation();c.preventDefault();a.find(".cred-media-button").css("z-index",1);a.find(".cred-popup-box").hide();b(this).closest(".cred-media-button").css("z-index",100);b("#cred-generic-shortcodes-box").__show()});b("#cred_include_captcha_scaffold").change(function(){l.genScaffold()});b("#cred_include_wpml_scaffold").change(function(){l.genScaffold()});a.on("click","#cred-scaffold-button-button",function(c){c.stopPropagation();
c.preventDefault();a.find(".cred-media-button").css("z-index",1);a.find(".cred-popup-box").hide();if(!l.genScaffold())return!1;b(this).closest(".cred-media-button").css("z-index",100);b("#cred-scaffold-box").__show()});a.on("click",".cred-icon-button",function(c){c.stopPropagation();c.preventDefault();a.find(".cred-media-button").css("z-index",1);a.find(".cred-popup-box").hide();b(this).closest(".cred-media-button").css("z-index",100);b(this).next(".cred-popup-box").__show()});b(document).mouseup(function(c){a.find(".cred-popup-box").filter(function(){return b(this).is(":visible")}).has(c.target).length===
0&&(a.find(".cred-media-button").css("z-index",1),a.find(".cred-popup-box").hide())});b(document).keyup(function(b){b.keyCode==27&&(a.find(".cred-media-button").css("z-index",1),a.find(".cred-popup-box").hide())});a.on("click",".cred-cred-cancel-close",function(){a.find(".cred-media-button").css("z-index",1);a.find(".cred-popup-box").hide()});return this}});b("#titlediv").prepend('<p class="cred-explain-text">'+i.locale.title_explain_text+"</p>").prepend('<a id="cred_add_forms_to_site_help" class="cred-help-link" style="position:absolute;top:0;right:0;" href="'+
i.help.add_forms_to_site.link+'" target="_blank" title="'+i.help.add_forms_to_site.text+'">'+i.help.add_forms_to_site.text+"</a>");d.prepend('<p class="cred-explain-text">'+i.locale.content_explain_text+"</p>");a.append('<input id="cred-submit" type="submit" class="button button-primary button-large" value="'+i.locale.submit_but+'" />');d.detach().appendTo("#credformcontentdiv .inside");k.length>0&&(k.insertAfter(d),k.addClass("cred-exclude"));a.find(".cred_related").removeClass("hide-if-js");c.hide();
b("#postbox-container-1").find(".cred_related").length||(b("#postbox-container-1").hide(),b("#post-body").removeClass("columns-2").addClass("columns-1"),b("#poststuff").removeClass("has-right-sidebar"),b("#poststuff .inner-sidebar").hide());var m=j.addEditorSwitchButton(i.locale.text_button_title).addClass("switch-text").click(l.toggleHighlight),h=j.addEditorSwitchButton(i.locale.syntax_button_title).addClass("switch-syntax").click(l.toggleHighlight);e?j.waitUntilElement("#ed_toolbar .ed_button",
function(){h.trigger("click");l.makeResizable(b("#content"))}):j.waitUntilElement("#ed_toolbar .ed_button",function(){m.trigger("click");l.makeResizable(b("#content"))});l.enableExtraCodeMirror();k.length>0&&(b("#cred-extra-css-editor").hasClass("cred-always-open")||b("#cred-extra-js-editor").hasClass("cred-always-open")?k.removeClass("closed"):k.addClass("closed"));w.init().autobind(!0).bind(["change","click"],"#post").sync();o.trigger("change",{key:"[post][post_type]",value:o.get("[post][post_type]")})}};
f.cred_cred=t})(window,jQuery,cred_settings,cred_utils,cred_gui,cred_mvc);
